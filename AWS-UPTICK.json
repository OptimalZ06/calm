{"status":{},"spec":{"description":"Uptick Web application. Deploy to AWS and access @ http:\/\/[haproxy_ip]","resources":{"client_attrs":{"HAPROXY":{"y":-220,"x":840},"APACHE_PHP":{"y":120,"x":500},"7df0cc1c_deployment_cloned_1_cloned_1":{"y":116.9399538106,"x":1077.9984603541},"MYSQL":{"y":480,"x":840}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MYSQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"614e22c6_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"55798d8c_runbook","main_task_local_reference":{"kind":"app_task","name":"614e22c6_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MYSQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"7d839765_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"631cf0ea_runbook","main_task_local_reference":{"kind":"app_task","name":"7d839765_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MYSQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"075e4b33_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"68b3c509_runbook","main_task_local_reference":{"kind":"app_task","name":"075e4b33_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MYSQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c857778e_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"94704c3b_runbook","main_task_local_reference":{"kind":"app_task","name":"c857778e_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MYSQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e9e7d2d3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"65ac9163_runbook","main_task_local_reference":{"kind":"app_task","name":"e9e7d2d3_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"MYSQL","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"9807fe1b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a992bd98_runbook","main_task_local_reference":{"kind":"app_task","name":"9807fe1b_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"d3ab8fc3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4fd20db5_runbook","main_task_local_reference":{"kind":"app_task","name":"d3ab8fc3_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"bfc74f9b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"e4dbbc0a_runbook","main_task_local_reference":{"kind":"app_task","name":"bfc74f9b_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a5bfd22c_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"0ecebc2f_runbook","main_task_local_reference":{"kind":"app_task","name":"a5bfd22c_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"208adab8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4e962233_runbook","main_task_local_reference":{"kind":"app_task","name":"208adab8_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"NodeJS"}],"name":"APACHE_PHP","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAPROXY"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"0ffc772f_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"0b37647d_runbook","main_task_local_reference":{"kind":"app_task","name":"0ffc772f_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAPROXY"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"345bfe30_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42c025e9_runbook","main_task_local_reference":{"kind":"app_task","name":"345bfe30_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAPROXY"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"8d2423f8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4f6625e7_runbook","main_task_local_reference":{"kind":"app_task","name":"8d2423f8_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAPROXY"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a483ed49_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ac17cd03_runbook","main_task_local_reference":{"kind":"app_task","name":"a483ed49_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAPROXY"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"9f7ae67d_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"5bb47e63_runbook","main_task_local_reference":{"kind":"app_task","name":"9f7ae67d_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"APACHE_PHP"}],"name":"HAPROXY","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NodeJS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"9807fe1b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a992bd98_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"9807fe1b_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NodeJS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"d3ab8fc3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4fd20db5_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"d3ab8fc3_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NodeJS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"bfc74f9b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"e4dbbc0a_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"bfc74f9b_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NodeJS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a5bfd22c_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"0ecebc2f_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"a5bfd22c_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"NodeJS"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"208adab8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4e962233_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"208adab8_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"MYSQL"}],"name":"NodeJS","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AWS_VM","name":"AWSMYSQLAHV","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{public_ip_address}@@","delay_secs":"0","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"os_type":"Linux","create_spec":{"name":"MySQL-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-east-1a","subnet_id":"subnet-1b3bd435","key_name":"CalmTest","region":"us-east-1","instance_initiated_shutdown_behavior":"","user_data":"","image_id":"ami-0866ef3d0608029a7","instance_type":"t2.nano","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-023d3069a229de58f"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/sda1","iops":1,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-5b1e4920","tag_list":[],"type":"","account_uuid":"39a1ea59-42ae-4366-62ed-24922002f8eb","associate_public_ip_address":true}},"variable_list":[]},{"description":"","action_list":[],"type":"AWS_VM","name":"AWSNGINX","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{public_ip_address}@@","delay_secs":"0","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"os_type":"Linux","create_spec":{"name":"NGINX-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-east-1a","subnet_id":"subnet-1b3bd435","key_name":"CalmTest","region":"us-east-1","instance_initiated_shutdown_behavior":"","user_data":"","image_id":"ami-0866ef3d0608029a7","instance_type":"t2.nano","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-023d3069a229de58f"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/sda1","iops":1,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-5b1e4920","tag_list":[],"type":"","account_uuid":"39a1ea59-42ae-4366-62ed-24922002f8eb","associate_public_ip_address":true}},"variable_list":[]},{"description":"","action_list":[],"type":"AWS_VM","name":"AWSHAPROXY","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{public_ip_address}@@","delay_secs":"0","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"os_type":"Linux","create_spec":{"name":"HAPROXY-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-east-1a","subnet_id":"subnet-1b3bd435","key_name":"CalmTest","region":"us-east-1","instance_initiated_shutdown_behavior":"","user_data":"","image_id":"ami-0866ef3d0608029a7","instance_type":"t2.nano","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-023d3069a229de58f"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/sda1","iops":1,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-5b1e4920","tag_list":[],"type":"","account_uuid":"39a1ea59-42ae-4366-62ed-24922002f8eb","associate_public_ip_address":true}},"variable_list":[]},{"description":"","action_list":[],"type":"AWS_VM","name":"AWSNodeJSVM","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{public_ip_address}@@","delay_secs":"0","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"os_type":"Linux","create_spec":{"name":"NodeJS-@@{calm_array_index}@@-@@{calm_time}@@","availability_zone_reference":null,"backup_policy":null,"type":"PROVISION_AWS_VM","cluster_reference":null,"resources":{"instance_profile_name":"","availability_zone":"us-east-1a","subnet_id":"subnet-1b3bd435","key_name":"CalmTest","region":"us-east-1","instance_initiated_shutdown_behavior":"","user_data":"","image_id":"ami-0866ef3d0608029a7","instance_type":"t2.nano","state":"RUNNING","security_group_list":[{"type":"","security_group_id":"sg-023d3069a229de58f"}],"block_device_map":{"data_disk_list":[],"type":"","root_disk":{"size_gb":8,"volume_type":"GP2","device_name":"\/dev\/sda1","iops":1,"snapshot_id":"","type":"","delete_on_termination":true}},"private_ip_address":"","vpc_id":"vpc-5b1e4920","tag_list":[],"type":"","account_uuid":"39a1ea59-42ae-4366-62ed-24922002f8eb","associate_public_ip_address":true}},"variable_list":[]}],"credential_definition_list":[{"username":"centos","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"CENTOS","editables":{"username":true,"secret":true}}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MYSQL"}],"name":"AWSMYSQL_PACKAGE","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"AWSMYSQL_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"PackageInstallTask"}],"name":"696811b8_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_package","name":"AWSMYSQL_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"PackageInstallTask","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n### Mysql installation\n# Download MySQL via yum\nsudo yum install -y \"http:\/\/repo.mysql.com\/mysql-community-release-el7.rpm\"\n\n# Update\n#sudo yum update -y\n\n# Install MySQL via yum\nsudo yum install -y mysql-community-server.x86_64\n\n# Start MySQL daemon & enable it\nsudo systemctl start mysqld\nsudo systemctl enable mysqld\n\n# Create DB folder\nsudo mkdir -p \/var\/uptick\/database\/mysql\/\ncd \/var\/uptick\/database\/mysql\/\n\n### Upload existing database\n# Install wget via yum\nsudo yum -y install wget\n\n# Download uptick database\nsudo wget https:\/\/raw.githubusercontent.com\/OptimalZ06\/uptick\/master\/databases\/mysql\/uptick.database.sql\n\n# Mysql secure installation\n# Mysql secure installation\nmysql -u root<<-EOF\nUPDATE mysql.user SET Password=PASSWORD('@@{MYSQL_PASSWORD}@@') WHERE User='root';\ncreate database Uptick;\nGRANT ALL ON Uptick.* TO '@@{MYSQL_USERNAME}@@'@'%' IDENTIFIED BY '@@{MYSQL_PASSWORD}@@';\nuse Uptick;\nsource \/var\/uptick\/database\/mysql\/uptick.database.sql;\nFLUSH PRIVILEGES;\nEOF\n\n# Restart MySQL service\nsudo systemctl restart mysqld","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"fa139f70_runbook_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"696811b8_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"AWSMYSQL_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"9f5b6937_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"add53bd1_runbook_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"9f5b6937_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"APACHE_PHP"}],"name":"AWSAPACHE_PHP_PACKAGE","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"AWSAPACHE_PHP_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"PackageInstallTask"}],"name":"27550204_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_package","name":"AWSAPACHE_PHP_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"PackageInstallTask","state":"ACTIVE","attrs":{"exit_status":[],"script":"####################\n# Install NGINX\n####################\n#!\/bin\/bash\nset -ex\n\nsudo adduser nucalm\necho \"nucalm\" | sudo passwd --stdin nucalm \n\n# Install Stuff\nsudo yum update -y\nsudo yum -y install epel-release\nsudo yum -y install nginx\nsudo yum install -y git\nsudo systemctl start nginx\n\n# Make Dir\nsudo mkdir -p \/var\/www\/projects\/uptick\/\n\n# Get Clone\nsudo git clone https:\/\/github.com\/OptimalZ06\/uptick.git\ncd uptick\/\n\n# Move repo files\nsudo mv -f * \/usr\/share\/nginx\/html\/\n\n# Set Permissions\nsudo chmod -R 755 \/usr\/share\/nginx\/html\/\ncd \/usr\/share\/nginx\/html\/\n\n## EDIT js\/data.js\n#var url = \"http:\/\/NODE_SERVER_IP_ADDDRESS:3000\/api\/\";\nsudo sed -i 's\/Current_Cloud\/@@{WHICH_CLOUD}@@\/' index.html\nsudo sed -i 's,Cloud_Icon,@@{CLOUD_ICON}@@,g' index.html\nsudo sed -i 's\/Currently_running_on\/Currently running on @@{WHICH_CLOUD}@@\/' index.html\nsudo sed -i 's\/NODE_SERVER_IP_ADDRESS\/@@{AWSNodeJSVM.address}@@\/' js\/data.js\n\n# Disable SE Linux\nsudo setenforce 0\n\n# Start NGINX\nsudo systemctl enable nginx\nsudo systemctl start nginx\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"124852e5_runbook_cloned_2","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"27550204_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"AWSAPACHE_PHP_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"11c3b039_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"afe7faff_runbook_cloned_2","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"11c3b039_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HAPROXY"}],"name":"AWSHAPROXY_PACKAGE","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"AWSHAPROXY_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"PackageInstallTask"}],"name":"feefd61c_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_package","name":"AWSHAPROXY_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"PackageInstallTask","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nsudo setenforce 0\nsudo sed -i 's\/permissive\/disabled\/' \/etc\/sysconfig\/selinux\n\nport=80\n#sudo yum update -y\nsudo yum install -y haproxy\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log     global\n  mode    http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats 0.0.0.0:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\nlisten admin\n  bind 127.0.0.1:22002\n  mode http\n  stats uri \/\nfrontend http\n  maxconn 2000\n  bind 0.0.0.0:80\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{APACHE_PHP.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\n\n\nfor host in $hosts\ndo\n   echo \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n\nsudo systemctl daemon-reload\nsudo systemctl enable haproxy\nsudo systemctl restart haproxy\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0f3b1d56_runbook_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"feefd61c_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"AWSHAPROXY_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"b0165015_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"77f817b9_runbook_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"b0165015_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"NodeJS"}],"name":"AWSNODE_PACKAGE","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"AWSNODE_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"PackageInstallTask"}],"name":"27550204_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_package","name":"AWSNODE_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"PackageInstallTask","state":"ACTIVE","attrs":{"exit_status":[],"script":"####################\n# Install NODEJS\n####################\ncurl --silent --location https:\/\/rpm.nodesource.com\/setup_9.x | sudo bash -\n\n# Yum Installs\n#sudo yum -y install epel-release\nsudo yum -y install nodejs\n#sudo yum update -y\nsudo yum install -y git\n\n# Make Dir\nsudo mkdir -p \/var\/www\/projects\/uptick\ncd \/var\/www\/projects\n\n# Clone repo\nsudo git clone https:\/\/github.com\/OptimalZ06\/uptick.git\n\n# Set permisisons\nsudo chmod -R 755 uptick\/\ncd uptick\/\n\n# disable se linux\nsetenforce 0\n\n# Edit config\/mssqlConfig.js\nsudo sed -i 's\/DB_SERVER_IPADDRESS\/@@{MYSQL.address}@@\/' config\/mysqlConfig.js\nsudo sed -i 's\/DB_USER\/@@{MYSQL_USERNAME}@@\/' config\/mysqlConfig.js\nsudo sed -i 's\/DB_PASSWORD\/@@{MYSQL_PASSWORD}@@\/' config\/mysqlConfig.js\nsudo sed -i 's\/DB_NAME\/@@{MYSQL_DB}@@\/' config\/mysqlConfig.js\n\nsudo npm build\nsudo npm install -g forever\n\nforever start server.js\n\n#sudo systemctl restart httpd\n#sudo systemctl enable httpd","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"124852e5_runbook_cloned_1_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"27550204_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"AWSNODE_PACKAGE"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"11c3b039_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"afe7faff_runbook_cloned_1_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"11c3b039_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","description":"","action_list":[],"name":"cbc66a9b_deployment_cloned_1","max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"AWSMYSQL_PACKAGE"}],"substrate_local_reference":{"kind":"app_substrate","name":"AWSMYSQLAHV"},"min_replicas":"1","variable_list":[]},{"type":"GREENFIELD","description":"","action_list":[],"editables":{"min_replicas":true,"max_replicas":true},"name":"7df0cc1c_deployment_cloned_2","max_replicas":"10","package_local_reference_list":[{"kind":"app_package","name":"AWSAPACHE_PHP_PACKAGE"}],"substrate_local_reference":{"kind":"app_substrate","name":"AWSNGINX"},"min_replicas":"2","variable_list":[]},{"type":"GREENFIELD","description":"","action_list":[],"name":"4d96f2c3_deployment_cloned_1","max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"AWSHAPROXY_PACKAGE"}],"substrate_local_reference":{"kind":"app_substrate","name":"AWSHAPROXY"},"min_replicas":"1","variable_list":[]},{"type":"GREENFIELD","description":"","action_list":[],"editables":{"min_replicas":true,"max_replicas":true},"name":"7df0cc1c_deployment_cloned_1_cloned_1","max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"AWSNODE_PACKAGE"}],"substrate_local_reference":{"kind":"app_substrate","name":"AWSNodeJSVM"},"min_replicas":"1","variable_list":[]}],"description":"","action_list":[{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Scale Out"}],"name":"ca587f8b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"7df0cc1c_deployment_cloned_2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Scale Out","attrs":{"scaling_count":"1","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","type":"SCALING","variable_list":[]}],"description":"","name":"feab36dc_runbook","main_task_local_reference":{"kind":"app_task","name":"ca587f8b_dag"},"variable_list":[]},"name":"Scale Out"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Scale In"}],"name":"300fde65_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"7df0cc1c_deployment_cloned_2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Scale In","attrs":{"scaling_count":"1","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","type":"SCALING","variable_list":[]}],"description":"","name":"c43628e8_runbook","main_task_local_reference":{"kind":"app_task","name":"300fde65_dag"},"variable_list":[]},"name":"Scale In"}],"name":"AWS","variable_list":[{"val_type":"STRING","description":"","name":"INSTANCE_PUBLIC_KEY","type":"LOCAL","value":"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCRAQbeHf9XqdSY4NxU9IkzzJaIqlzNPumIQO\/TLaVix+2PtH0XUo9zjgtMNxc4k98Rmj4nxdpoj7ppI9ocAKmbwbUNZ2jrwbeXuKBYil\/uphURwfXwdjriVl5Hlui\/Dnp3z9EzvDG\/sN+jooKWS0blSQrnhSZF3W2riY6mtHrpfO1rqeeNZNSsx0a9rO+DiPVlMbPdmGb14OmNrscJaMA2+egFrrB\/TMFhURfecwhYYXZNHXbCjUo8vzrlXe0I0UqGZNZ8ic4qD0h3eHcpRVI5sw\/Qdag5VjvWJayZCKK94VGkh92\/brs1oFZZjYElnYJMtEYuXcqVVnmU+6LbI2jb","label":"","attrs":{"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"MYSQL_PASSWORD","type":"SECRET","value":"","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""}},{"val_type":"STRING","description":"","name":"MYSQL_USERNAME","type":"LOCAL","value":"root","label":"","attrs":{"type":""}},{"val_type":"STRING","description":"","name":"MYSQL_DB","type":"LOCAL","value":"Uptick","label":"","attrs":{"type":""}},{"val_type":"STRING","description":"","name":"WHICH_CLOUD","type":"LOCAL","value":"AWS","label":"","attrs":{"type":""}},{"val_type":"STRING","description":"","name":"CLOUD_ICON","type":"LOCAL","value":"https:\/\/awsmedia.s3.amazonaws.com\/favicon.ico","label":"","attrs":{"type":""}}]}],"default_credential_local_reference":{"kind":"app_credential","name":"CENTOS"},"type":"USER"},"name":"AWS-UPTICK"},"api_version":"3.0","metadata":{"last_update_time":"1536960271831856","kind":"blueprint","spec_version":11,"creation_time":"1534362044098098","name":"AWS-UPTICK"}}
